;/*FB_PKG_DELIM*/

__d("FDSPhotoDownloadFilled20Icon",["cr:15409"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:15409")}),98);
__d("FDSPhotoDownloadFilled20PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("1433212"),20);b=a;g["default"]=b}),98);
__d("MWChatMediaViewerControls.react",["fbt","FDSCircleButton.react","FDSPhotoDownloadFilled20Icon","FDSShareFilled20Icon","FDSTooltip.react","Int64Hooks","LSFactory","LSIntEnum","LSMessagePointQueryStoredProcedure","LSVerifyThreadRowExistsStoredProcedure","MWChatMessageId","MWXRow.react","MWXRowItem.react","ODS","ReQL","ReQLSuspense","emptyFunction","promiseDone","react","react-compiler-runtime","useMWChatForward","useMWV2ForwardMessage","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=l||(l=d("react"));l.useCallback;var n=h._(/*BTDS*/"T\u1ea3i xu\u1ed1ng"),o=h._(/*BTDS*/"Chuy\u1ec3n ti\u1ebfp");function p(a,b){var e=d("react-compiler-runtime").c(18),g=(i||(i=c("useReStore")))(),h,k;e[0]!==g||e[1]!==b?(h=function(){return b!=null?d("ReQL").fromTableAscending(g.tables.threads,["threadType"]).getKeyRange(b).map(q):d("ReQL").empty()},k=[g,b],e[0]=g,e[1]=b,e[2]=h,e[3]=k):(h=e[2],k=e[3]);var l=d("ReQLSuspense").useFirst(h,k,f.id+":62");e[4]!==g||e[5]!==a?(h=function(){return a!=null?d("ReQL").fromTableAscending(g.tables.messages.index("messageId")).getKeyRange(a):d("ReQL").empty()},k=[g,a],e[4]=g,e[5]=a,e[6]=h,e[7]=k):(h=e[6],k=e[7]);var m=d("ReQLSuspense").useFirst(h,k,f.id+":74");e[8]!==g||e[9]!==m||e[10]!==a||e[11]!==l||e[12]!==b?(h=function(){if(a==null||b==null)return;if(l==null){c("promiseDone")(g.runInTransaction(function(a){return c("LSVerifyThreadRowExistsStoredProcedure")(c("LSFactory")(a),{syncGroup:(j||(j=d("LSIntEnum"))).ofNumber(1),threadKey:b})},"readwrite",void 0,void 0,f.id+":90"));return}m==null&&c("promiseDone")(g.runInTransaction(function(d){return c("LSMessagePointQueryStoredProcedure")(c("LSFactory")(d),{messageId:a,threadKey:b,threadType:l})},"readwrite",void 0,void 0,f.id+":103"))},k=[g,m,a,l,b],e[8]=g,e[9]=m,e[10]=a,e[11]=l,e[12]=b,e[13]=h,e[14]=k):(h=e[13],k=e[14]);d("Int64Hooks").useEffectInt64(h,k);e[15]!==m||e[16]!==l?(h=[m,l],e[15]=m,e[16]=l,e[17]=h):h=e[17];return h}function q(a){a=a.threadType;return a}function a(a){var b=d("react-compiler-runtime").c(11),e=a.attachmentID,f=a.canForward,g=a.downloadLink,h=a.isCrossTransportForwardEnabled,i=a.isSecureForwardEnabled;a=a.messageID;f=f===void 0?!0:f;h=h===void 0?!1:h;i=i===void 0?!1:i;var j;b[0]!==g?(j=g!=null?m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("FDSTooltip.react"),{align:"middle",tooltip:n,children:m.jsx(c("FDSCircleButton.react"),{icon:c("FDSPhotoDownloadFilled20Icon"),label:n,linkProps:{download:!0,target:"_blank",url:g},size:36,type:"secondary-on-media"})})}):null,b[0]=g,b[1]=j):j=b[1];b[2]!==e||b[3]!==f||b[4]!==h||b[5]!==i||b[6]!==a?(g=f===!0?m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("FDSTooltip.react"),{align:"middle",tooltip:o,children:m.jsx(s,{attachmentID:e,isCrossTransportForwardEnabled:h,isSecureForwardEnabled:i,messageID:a})})}):null,b[2]=e,b[3]=f,b[4]=h,b[5]=i,b[6]=a,b[7]=g):g=b[7];b[8]!==j||b[9]!==g?(e=m.jsxs(c("MWXRow.react"),{paddingTop:0,spacing:8,children:[j,g]}),b[8]=j,b[9]=g,b[10]=e):e=b[10];return e}function r(a){var b=d("react-compiler-runtime").c(8),e=a.isCrossTransportForwardEnabled,f=a.isSecureForwardEnabled,g=a.messageID;a=a.onForwardSend;e=e===void 0?!1:e;f=f===void 0?!1:f;f=f?"secure":e?"cross_transport":"open_";b[0]!==f||b[1]!==g||b[2]!==a?(e={forwardDialogType:f,messageID:g,onClose:c("emptyFunction"),onSend:a},b[0]=f,b[1]=g,b[2]=a,b[3]=e):e=b[3];var h=c("useMWChatForward")(e);b[4]!==h?(f=function(){(k||(k=d("ODS"))).bumpEntityKey(3185,"mwchat_media_viewer","forward"),h&&h.onClick()},b[4]=h,b[5]=f):f=b[5];var i=f;b[6]!==i?(g=m.jsx(c("FDSCircleButton.react"),{icon:c("FDSShareFilled20Icon"),label:o,onPress:function(a){return i()},size:36,testid:void 0,type:"secondary-on-media"}),b[6]=i,b[7]=g):g=b[7];return g}function s(a){var b=d("react-compiler-runtime").c(11),c=a.attachmentID,e=a.isCrossTransportForwardEnabled,f=a.isSecureForwardEnabled;a=a.messageID;e=e===void 0?!1:e;f=f===void 0?!1:f;var g;b[0]!==a?(g=d("MWChatMessageId").getMessageId(a),b[0]=a,b[1]=g):g=b[1];g=g;var h;b[2]!==a?(h=d("MWChatMessageId").getThreadId(a),b[2]=a,b[3]=h):h=b[3];h=h;g=p(g,h);h=g[0];g=g[1];if(h==null||g==null)return null;var i;b[4]!==c||b[5]!==e||b[6]!==f||b[7]!==h||b[8]!==a||b[9]!==g?(i=m.jsx(t,{attachmentID:c,isCrossTransportForwardEnabled:e,isSecureForwardEnabled:f,message:h,messageID:a,messageThreadType:g}),b[4]=c,b[5]=e,b[6]=f,b[7]=h,b[8]=a,b[9]=g,b[10]=i):i=b[10];return i}function t(a){var b=d("react-compiler-runtime").c(7),e=a.attachmentID,f=a.isCrossTransportForwardEnabled,g=a.isSecureForwardEnabled,h=a.message,i=a.messageID;a=a.messageThreadType;f=f===void 0?!1:f;g=g===void 0?!1:g;var j=d("useMWV2ForwardMessage").useMWV2ForwardMessage(h,a,e);b[0]!==j?(h=function(a){return c("promiseDone")(j(a))},b[0]=j,b[1]=h):h=b[1];a=h;b[2]!==f||b[3]!==g||b[4]!==i||b[5]!==a?(e=m.jsx(r,{isCrossTransportForwardEnabled:f,isSecureForwardEnabled:g,messageID:i,onForwardSend:a}),b[2]=f,b[3]=g,b[4]=i,b[5]=a,b[6]=e):e=b[6];return e}g["default"]=a}),226);
__d("MWV2MediaViewerThreadCutoverWrapper.react",["LSThreadMediaGalleryGroup","MWChatAttachmentMediaState.react","MWV2MediaViewerContext.react","cr:14186","emptyFunction","justknobx","react","react-compiler-runtime","useMAWLoadMoreCutoverThreadSharedAttachments","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl","useMWV2MediaViewerSecurePlayableUrl","useMWV2MediaViewerSecurePreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){var e=d("react-compiler-runtime").c(27),f=a.children,g=a.initialAttachment,h=a.openThreadKey,k=a.secureThreadKey;a=a.threadType;var l;e[0]!==k||e[1]!==a?(l={threadKey:k,threadType:a},e[0]=k,e[1]=a,e[2]=l):l=e[2];b("cr:14186")(l);e[3]===Symbol["for"]("react.memo_cache_sentinel")?(l={entrypoint:"media_viewer"},e[3]=l):l=e[3];var m;e[4]===Symbol["for"]("react.memo_cache_sentinel")?(m=c("justknobx")._("3233"),e[4]=m):m=e[4];k=c("useMAWLoadMoreCutoverThreadSharedAttachments")(k,h,a,l,c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,!1,m);h=k.attachments;a=k.onLoadMore;var n=j,o=c("useMWV2MediaViewerOpenPreviewUrl")(),p=c("useMWV2MediaViewerOpenPlayableUrl")(),q=c("useMWV2MediaViewerOpenDownloadUrl")(),r=c("useMWV2MediaViewerSecurePreviewUrl")(),s=c("useMWV2MediaViewerSecurePlayableUrl")();e[5]!==o||e[6]!==r?(l=function(a,b,c){if(!a)return"";return!n(a)?o(a,b,c):r(a,b,c)},e[5]=o,e[6]=r,e[7]=l):l=e[7];m=l;e[8]!==p||e[9]!==s?(k=function(a,b,c){if(a==null)return"";return!n(a)?p(a,b,c):s(a,b,c)},e[8]=p,e[9]=s,e[10]=k):k=e[10];l=k;e[11]!==q||e[12]!==s?(k=function(a,b,c){if(a==null)return"";return!n(a)?q(a,b,c):s(a,b,c)},e[11]=q,e[12]=s,e[13]=k):k=e[13];k=k;var t;e[14]!==h||e[15]!==f||e[16]!==l||e[17]!==m||e[18]!==g?(t=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:h,getIsSecureThread:n,getPlayableUrl:l,getPreviewUrl:m,initialAttachment:g,children:f}),e[14]=h,e[15]=f,e[16]=l,e[17]=m,e[18]=g,e[19]=t):t=e[19];e[20]!==h||e[21]!==k||e[22]!==l||e[23]!==m||e[24]!==a||e[25]!==t?(f=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:k,getPlayableUrl:l,getPreviewUrl:m,heroLoggingComponent:c("emptyFunction"),loadMore:a,media:h,children:t}),e[20]=h,e[21]=k,e[22]=l,e[23]=m,e[24]=a,e[25]=t,e[26]=f):f=e[26];return f}function j(a){return!((a==null?void 0:a.transportKey)==="FBBroker"||(a==null?void 0:a.transportKey)==="FBLegacyBroker")}g["default"]=a}),98);